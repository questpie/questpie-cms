---
title: Core Concepts
description: Key concepts to understand QUESTPIE CMS
---

# Core Concepts

Understanding these core concepts will help you work effectively with QUESTPIE CMS.

## Architecture Overview

QUESTPIE CMS separates concerns into two main packages:

```
┌─────────────────────────────────────────────────────────────┐
│                      Your Application                        │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌─────────────────────┐     ┌─────────────────────┐       │
│  │   Backend (q)       │     │   Admin UI (qa)     │       │
│  │   questpie          │     │   @questpie/admin   │       │
│  ├─────────────────────┤     ├─────────────────────┤       │
│  │ • Collections       │     │ • Field configs     │       │
│  │ • Globals           │     │ • Table views       │       │
│  │ • Validation        │     │ • Form views        │       │
│  │ • Hooks             │     │ • Dashboard         │       │
│  │ • Access control    │     │ • Sidebar           │       │
│  │ • Authentication    │     │ • Blocks            │       │
│  │ • Jobs              │     │ • Preview           │       │
│  └─────────────────────┘     └─────────────────────┘       │
│           │                           │                      │
│           │    Types flow from        │                      │
│           └──────backend to ──────────┘                      │
│                   admin                                      │
└─────────────────────────────────────────────────────────────┘
```

**Backend (`questpie`)**: Handles data, validation, business logic, and authentication. Runs on the server.

**Admin UI (`@questpie/admin`)**: Provides the user interface for content management. Configures how data is displayed and edited.

## Key Concepts

### 1. Builder Pattern

Both packages use a fluent builder API for configuration:

```typescript
// Backend builder - ends with .build()
const cms = q({ name: "my-cms" })
  .collections({...})
  .auth({...})
  .build({ db: { url: "..." } });  // Creates runtime instance

// Admin builder - NO .build()
const admin = qa()
  .collections({...})
  .sidebar({...});  // State IS the config
```

The key difference: backend requires `.build()` to create database tables and runtime instances. Admin is pure configuration that's used directly.

[Learn more about the Builder Pattern →](/docs/core-concepts/builder-pattern)

### 2. Collections

Collections are your data models. They define:
- Database schema (fields)
- Relations to other collections
- Validation rules
- Lifecycle hooks
- Access control

```typescript
// Backend: defines the data structure
const posts = q.collection("posts")
  .fields({
    title: text("title").notNull(),
    content: text("content"),
    published: boolean("published").default(false),
  });

// Admin: defines how it's displayed/edited
const postsAdmin = qa.collection("posts")
  .fields(({ r }) => ({
    title: r.text({ label: "Title" }),
    content: r.richText({ label: "Content" }),
    published: r.switch({ label: "Published" }),
  }));
```

[Learn more about Collections →](/docs/core-concepts/collections)

### 3. Fields

Fields define the data types in your collections:

| Category | Backend (Drizzle) | Admin (UI) |
|----------|------------------|------------|
| Text | `text()`, `varchar()` | `r.text()`, `r.richText()` |
| Numbers | `integer()`, `numeric()` | `r.number()`, `r.slider()` |
| Boolean | `boolean()` | `r.checkbox()`, `r.switch()` |
| Date/Time | `timestamp()`, `date()` | `r.datetime()`, `r.date()` |
| Selection | `text()` with enum | `r.select()`, `r.radio()` |
| Relations | `.relations()` | `r.relation()` |
| JSON | `jsonb()` | `r.json()`, `r.blocks()` |
| Files | `.upload()` | `r.file()`, `r.image()` |

[Learn more about Fields →](/docs/core-concepts/fields)

### 4. Authentication

QUESTPIE uses Better Auth for authentication:

```typescript
const cms = q({ name: "my-cms" })
  .use(starterModule)  // Includes auth collections
  .auth({
    emailAndPassword: { enabled: true },
    socialProviders: {
      google: { clientId: "...", clientSecret: "..." },
    },
  })
  .build({...});
```

The starter module provides user, session, account, and API key collections.

[Learn more about Authentication →](/docs/core-concepts/authentication)

## Data Flow

```
┌─────────────┐    HTTP     ┌─────────────┐    Direct    ┌──────────┐
│   Browser   │ ──────────> │   Server    │ ──────────> │ Database │
│   (Admin)   │             │   (CMS)     │              │ (Postgres)│
└─────────────┘             └─────────────┘              └──────────┘
      │                           │
      │ Client SDK                │ Server API
      │ createClient()            │ cms.api.collections
      │                           │
      ▼                           ▼
┌─────────────┐             ┌─────────────┐
│ Type-safe   │             │ Type-safe   │
│ HTTP calls  │             │ DB queries  │
└─────────────┘             └─────────────┘
```

**Server API** (`cms.api`): Direct database access for server-side code.

**Client SDK** (`createClient()`): HTTP client for browser and external services.

## Project Structure

Recommended organization:

```
src/
├── questpie/
│   ├── server/                 # Backend CMS
│   │   ├── cms.ts              # Main CMS instance
│   │   ├── collections/        # Collection definitions
│   │   │   ├── posts.ts
│   │   │   └── index.ts
│   │   └── modules/            # Custom modules
│   │
│   └── admin/                  # Admin UI config
│       ├── admin.ts            # Main admin config
│       ├── collections/        # Collection UI configs
│       │   ├── posts.ts
│       │   └── index.ts
│       └── sidebar.ts
│
├── routes/
│   ├── api/cms.ts              # CMS API routes
│   └── admin.tsx               # Admin UI route
│
└── lib/
    └── cms-client.ts           # Client instance
```

## Type Safety

QUESTPIE provides end-to-end type safety:

```typescript
// Define once in backend
const posts = q.collection("posts")
  .fields({
    title: text("title").notNull(),
  });

// Types flow to admin
const postsAdmin = qa.collection("posts")
  .fields(({ r }) => ({
    title: r.text(),  // TypeScript knows "title" exists
  }));

// Types flow to client
const client = createClient<typeof cms>({...});
const { docs } = await client.collections.posts.find();
//     ^? { id: string, title: string, ... }[]
```

## Related

- [Builder Pattern](/docs/core-concepts/builder-pattern) - The q() and qa() APIs
- [Collections](/docs/core-concepts/collections) - Data models in depth
- [Fields](/docs/core-concepts/fields) - Field types overview
- [Authentication](/docs/core-concepts/authentication) - Auth integration
