---
title: Logger Adapter
description: Logging configuration
---

# Logger Adapter

The logger adapter provides structured logging for your CMS.

## Configuration

### Pino (Default)

QUESTPIE uses Pino for high-performance logging:

```typescript
const cms = q({ name: "my-cms" })
  .build({
    logger: {
      level: "info", // "trace" | "debug" | "info" | "warn" | "error" | "fatal"
      pretty: process.env.NODE_ENV === "development",
    },
  });
```

### Custom Pino Configuration

```typescript
import pino from "pino";

const cms = q({ name: "my-cms" })
  .build({
    logger: pino({
      level: "info",
      transport: {
        target: "pino-pretty",
        options: {
          colorize: true,
          translateTime: "HH:MM:ss",
          ignore: "pid,hostname",
        },
      },
    }),
  });
```

### With Log Destinations

```typescript
import pino from "pino";

const cms = q({ name: "my-cms" })
  .build({
    logger: pino({
      level: "info",
    }, pino.destination({
      dest: "./logs/app.log",
      sync: false, // Async writing
    })),
  });
```

### Multiple Destinations

```typescript
import pino from "pino";

const streams = [
  // Console
  { stream: process.stdout },
  // File
  { stream: pino.destination("./logs/app.log") },
  // Error file (only errors)
  { level: "error", stream: pino.destination("./logs/error.log") },
];

const cms = q({ name: "my-cms" })
  .build({
    logger: pino({ level: "info" }, pino.multistream(streams)),
  });
```

## Using the Logger

### Basic Logging

```typescript
// Access logger from CMS
cms.logger.info("Server started");
cms.logger.debug("Processing request", { path: "/api/posts" });
cms.logger.warn("Rate limit approaching", { userId: "123" });
cms.logger.error("Failed to process", { error: err.message });
```

### With Context

```typescript
// Create child logger with context
const requestLogger = cms.logger.child({
  requestId: "req-123",
  userId: "user-456",
});

requestLogger.info("Processing request");
// Output: {"requestId":"req-123","userId":"user-456","msg":"Processing request",...}
```

### Log Levels

```typescript
// All levels (from most to least verbose)
cms.logger.trace("Very detailed info");  // level 10
cms.logger.debug("Debug information");   // level 20
cms.logger.info("General information");  // level 30
cms.logger.warn("Warning message");      // level 40
cms.logger.error("Error occurred");      // level 50
cms.logger.fatal("Fatal error");         // level 60
```

### Structured Data

```typescript
// Log with structured data
cms.logger.info({
  event: "user_login",
  userId: "123",
  ip: "192.168.1.1",
  userAgent: "Mozilla/5.0...",
}, "User logged in");

// Output: {"event":"user_login","userId":"123",...,"msg":"User logged in"}
```

### Error Logging

```typescript
try {
  await riskyOperation();
} catch (error) {
  cms.logger.error({
    err: error, // Pino serializes Error objects
    operation: "riskyOperation",
    context: { someData: "value" },
  }, "Operation failed");
}
```

## Request Logging

### Middleware Example

```typescript
import { Hono } from "hono";

const app = new Hono();

app.use("*", async (c, next) => {
  const requestId = crypto.randomUUID();
  const start = Date.now();

  // Add request logger to context
  c.set("logger", cms.logger.child({ requestId }));

  c.get("logger").info({
    method: c.req.method,
    path: c.req.path,
    ip: c.req.header("x-forwarded-for"),
  }, "Request started");

  await next();

  const duration = Date.now() - start;
  c.get("logger").info({
    status: c.res.status,
    duration,
  }, "Request completed");
});
```

## Log Output

### Development (Pretty)

```
[14:32:01] INFO: Server started
[14:32:02] INFO: Request started
    method: "GET"
    path: "/api/posts"
[14:32:02] INFO: Request completed
    status: 200
    duration: 45
```

### Production (JSON)

```json
{"level":30,"time":1703001121000,"msg":"Server started"}
{"level":30,"time":1703001122000,"method":"GET","path":"/api/posts","msg":"Request started"}
{"level":30,"time":1703001122045,"status":200,"duration":45,"msg":"Request completed"}
```

## External Services

### Sending to Datadog

```typescript
import pino from "pino";

const transport = pino.transport({
  targets: [
    {
      target: "pino/file",
      options: { destination: 1 }, // stdout
    },
    {
      target: "pino-datadog-transport",
      options: {
        apiKey: process.env.DATADOG_API_KEY,
        service: "my-cms",
        env: process.env.NODE_ENV,
      },
    },
  ],
});

const cms = q({ name: "my-cms" })
  .build({
    logger: pino({ level: "info" }, transport),
  });
```

### Sending to Logtail

```typescript
import pino from "pino";

const transport = pino.transport({
  target: "@logtail/pino",
  options: { sourceToken: process.env.LOGTAIL_TOKEN },
});

const cms = q({ name: "my-cms" })
  .build({
    logger: pino({ level: "info" }, transport),
  });
```

## Configuration Options

```typescript
interface LoggerConfig {
  // Log level
  level?: "trace" | "debug" | "info" | "warn" | "error" | "fatal";

  // Enable pretty printing
  pretty?: boolean;

  // Custom Pino instance
  instance?: Logger;

  // Redact sensitive fields
  redact?: string[];
}
```

### Redacting Sensitive Data

```typescript
const cms = q({ name: "my-cms" })
  .build({
    logger: pino({
      level: "info",
      redact: [
        "password",
        "token",
        "authorization",
        "req.headers.authorization",
        "user.email",
      ],
    }),
  });

// These fields will show as "[Redacted]"
cms.logger.info({ user: { email: "test@example.com", name: "John" } });
// Output: {"user":{"email":"[Redacted]","name":"John"}}
```

## Best Practices

### 1. Use Appropriate Levels

```typescript
// Development debugging
cms.logger.debug("Variable value", { data });

// Normal operations
cms.logger.info("User created", { userId });

// Potential issues
cms.logger.warn("Retry attempt", { attempt: 3, maxAttempts: 5 });

// Errors
cms.logger.error({ err }, "Failed to process request");

// System failures
cms.logger.fatal("Database connection lost");
```

### 2. Include Context

```typescript
// ❌ Bad: no context
cms.logger.error("Error occurred");

// ✅ Good: includes context
cms.logger.error({
  err,
  userId: "123",
  action: "createPost",
  input: { title: "..." },
}, "Failed to create post");
```

### 3. Use Child Loggers

```typescript
// Create context-aware logger per request
app.use("*", async (c, next) => {
  const logger = cms.logger.child({
    requestId: c.req.header("x-request-id"),
    traceId: c.req.header("x-trace-id"),
  });

  c.set("logger", logger);
  await next();
});
```

### 4. Don't Log Sensitive Data

```typescript
// ❌ Bad: logs password
cms.logger.info({ email, password }, "Login attempt");

// ✅ Good: only safe data
cms.logger.info({ email, success: true }, "Login successful");
```

## Related

- [Adapters Overview](/docs/backend/adapters) - All backend adapters
- [Getting Started](/docs/getting-started) - Quick start guide
