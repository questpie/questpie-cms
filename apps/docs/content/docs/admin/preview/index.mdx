---
title: Preview System Overview
description: Real-time content preview while editing
---

# Preview System Overview

The preview system enables real-time content preview directly in the admin interface, allowing editors to see their changes before publishing.

## Key Features

- **Live Preview** - See changes in real-time as you edit
- **Split View** - Form and preview side-by-side
- **Device Simulation** - Preview on different screen sizes
- **Click-to-Focus** - Click on preview to focus the corresponding field

## How It Works

```
Admin Editor                 Preview Panel
┌─────────────┐            ┌─────────────┐
│             │  iframe    │             │
│  Form       │  ───────>  │  Your Site  │
│  Fields     │  postMsg   │  (preview   │
│             │  <───────  │   mode)     │
└─────────────┘            └─────────────┘
```

1. Editor opens a record with preview enabled
2. Admin loads your site in an iframe with `?preview=true`
3. Form changes are sent to the iframe via postMessage
4. Your site renders the preview with live data

## Enabling Preview

Add `.preview()` to your collection config:

```typescript
export const pagesAdmin = builder
  .collection("pages")
  .meta({ label: "Pages" })
  .preview({
    url: (values) => {
      const slug = values.slug || values.id;
      return `/pages/${slug}?preview=true`;
    },
    enabled: true,
    position: "right",
    defaultWidth: 50,
  })
  .fields(({ r }) => ({...}))
  .form(({ v, f }) => ({...}));
```

## Preview Configuration

```typescript
.preview({
  // Generate URL from form values
  url: (values) => `/pages/${values.slug}?preview=true`,

  // Enable/disable preview (can be dynamic)
  enabled: true,
  // Or: enabled: (values) => values.status !== "draft",

  // Panel position
  position: "right",  // "right" | "bottom"

  // Default width as percentage (1-100)
  defaultWidth: 50,

  // Minimum width (optional)
  minWidth: 30,

  // Show resize handle
  resizable: true,

  // Refresh strategy
  refreshOn: "change",  // "change" | "save" | "manual"

  // Debounce delay (ms) for "change" refresh
  debounceMs: 500,
})
```

## URL Generation

The `url` function receives current form values and should return the preview URL:

```typescript
// Simple slug-based URL
url: (values) => `/pages/${values.slug}?preview=true`

// With locale
url: (values, locale) => `/${locale}/pages/${values.slug}?preview=true`

// Dynamic based on type
url: (values) => {
  if (values.type === "blog") {
    return `/blog/${values.slug}?preview=true`;
  }
  return `/pages/${values.slug}?preview=true`;
}

// For new items (no ID yet)
url: (values) => {
  const slug = values.slug || "untitled";
  return `/preview/pages/${slug}?draft=true`;
}
```

## Frontend Setup

Your frontend needs to handle preview mode:

```tsx
// pages/[slug].tsx
export default function Page({ params }) {
  const isPreview = useSearchParams().get("preview") === "true";

  // In preview mode, use preview data from admin
  if (isPreview) {
    return <PreviewPage />;
  }

  // Normal page rendering
  return <PublishedPage slug={params.slug} />;
}

function PreviewPage() {
  const [previewData, setPreviewData] = useState(null);

  useEffect(() => {
    // Listen for preview updates from admin
    const handler = (event) => {
      if (event.data.type === "questpie:preview:update") {
        setPreviewData(event.data.values);
      }
    };

    window.addEventListener("message", handler);
    return () => window.removeEventListener("message", handler);
  }, []);

  if (!previewData) {
    return <div>Loading preview...</div>;
  }

  return <PageRenderer data={previewData} />;
}
```

## Preview Hook

Use the preview hook for easier integration:

```tsx
import { usePreviewData } from "@questpie/admin/preview";

function PreviewPage() {
  const { data, isPreview } = usePreviewData();

  if (!isPreview) {
    return <NormalPage />;
  }

  return <PageRenderer data={data} />;
}
```

## Position Options

### Right Panel (Default)

```typescript
.preview({
  position: "right",
  defaultWidth: 50,  // 50% of viewport
})
```

Best for:
- Wide forms
- Horizontal content layouts
- Desktop-focused editing

### Bottom Panel

```typescript
.preview({
  position: "bottom",
  defaultWidth: 40,  // 40% of viewport height
})
```

Best for:
- Narrow forms
- Mobile preview simulation
- Vertical content layouts

## Conditional Preview

Enable preview conditionally:

```typescript
.preview({
  url: (values) => `/pages/${values.slug}?preview=true`,

  // Only enable for published or draft items
  enabled: (values) => ["published", "draft"].includes(values.status),
})
```

## Example: Barbershop Barber Preview

```typescript
export const barbersAdmin = builder
  .collection("barbers")
  .meta({
    label: { en: "Barbers", sk: "Holici" },
    icon: UsersIcon,
  })
  .preview({
    url: (values) => {
      // Generate URL-friendly slug from name
      const name = values.name as string | undefined;
      const slug = name?.toLowerCase().replace(/\s+/g, "-") || "barber";
      return `/barbers/${slug}?preview=true`;
    },
    enabled: true,
    position: "right",
    defaultWidth: 50,
  })
  .fields(({ r }) => ({
    name: r.text({ label: "Name", required: true }),
    bio: r.richText({ label: "Bio" }),
    avatar: r.upload({ label: "Photo" }),
    // ...
  }));
```

## Next Steps

<Cards>
  <Card href="/docs/admin/preview/setup" title="Setup Guide" description="Complete setup instructions" />
  <Card href="/docs/admin/preview/click-to-focus" title="Click-to-Focus" description="Navigate from preview to fields" />
</Cards>
