---
title: Custom Modules
description: Building reusable modules for QUESTPIE Admin
---

# Custom Modules

Modules are the way to package and distribute QUESTPIE Admin extensions. A module can include fields, views, widgets, collections, and more.

## Module Structure

A module is simply a `qa()` builder with extensions:

```typescript
const myModule = qa()
  .fields({ ... })
  .views({ ... })
  .widgets({ ... })
  .collections({ ... })
  .sidebar(({ s }) => [...])
  .dashboard(({ w }) => ({ ... }));
```

## Creating a Module

### Basic Module

```typescript
// modules/seo-module.ts
import { qa, field } from "@questpie/admin/client";

// Custom field
const seoTitleField = field("seoTitle", {
  component: SeoTitleField,
  cell: SeoTitleCell,
  config: {} as { label?: string; maxLength?: number },
  defaultConfig: { maxLength: 60 },
  createZod: (c) => z.string().max(c.maxLength ?? 60),
});

const seoDescriptionField = field("seoDescription", {
  component: SeoDescriptionField,
  config: {} as { label?: string; maxLength?: number },
  defaultConfig: { maxLength: 160 },
});

// Export module
export const seoModule = qa()
  .fields({
    seoTitle: seoTitleField,
    seoDescription: seoDescriptionField,
  });

// Usage
const admin = qa()
  .use(adminModule)
  .use(seoModule);  // Now r.seoTitle() and r.seoDescription() are available
```

### Module with Collections

```typescript
// modules/blog-module.ts
import { qa } from "@questpie/admin/client";
import { Newspaper, Tag, Users } from "lucide-react";

// Define collection configs
const postsCollection = qa.collection("posts")
  .meta({
    label: "Posts",
    icon: Newspaper,
  });

const categoriesCollection = qa.collection("categories")
  .meta({
    label: "Categories",
    icon: Tag,
  });

const authorsCollection = qa.collection("authors")
  .meta({
    label: "Authors",
    icon: Users,
  });

// Export module with collections and sidebar
export const blogModule = qa()
  .collections({
    posts: postsCollection,
    categories: categoriesCollection,
    authors: authorsCollection,
  })
  .sidebar(({ s }) => [
    s.section({
      label: "Blog",
      icon: Newspaper,
      items: [
        s.collection({ collection: "posts" }),
        s.collection({ collection: "categories" }),
        s.collection({ collection: "authors" }),
      ],
    }),
  ]);
```

### Module with Widgets and Dashboard

```typescript
// modules/analytics-module.ts
import { qa, widget } from "@questpie/admin/client";

const pageViewsWidget = widget("pageViews", {
  component: PageViewsChart,
  config: {} as { period: "day" | "week" | "month" },
});

const topPagesWidget = widget("topPages", {
  component: TopPagesList,
  config: {} as { limit: number },
});

export const analyticsModule = qa()
  .widgets({
    pageViews: pageViewsWidget,
    topPages: topPagesWidget,
  })
  .dashboard(({ w }) => ({
    widgets: [
      w.pageViews({ period: "week" }),
      w.topPages({ limit: 10 }),
    ],
  }));
```

## Module Patterns

### Configurable Module

```typescript
// modules/blog-module.ts
interface BlogModuleOptions {
  enableComments?: boolean;
  enableDrafts?: boolean;
  customFields?: Record<string, any>;
}

export function createBlogModule<TApp>(options: BlogModuleOptions = {}) {
  const builder = qa<TApp>().use(adminModule);

  const collections: Record<string, any> = {
    posts: builder.collection("posts")
      .fields(({ r }) => ({
        title: r.text({ label: "Title" }),
        content: r.richText({ label: "Content" }),
        ...(options.enableDrafts && {
          status: r.select({
            label: "Status",
            options: [
              { label: "Draft", value: "draft" },
              { label: "Published", value: "published" },
            ],
          }),
        }),
        ...options.customFields,
      })),
  };

  if (options.enableComments) {
    collections.comments = builder.collection("comments")
      .fields(({ r }) => ({
        content: r.textarea({ label: "Content" }),
        author: r.text({ label: "Author" }),
      }));
  }

  return qa().collections(collections);
}

// Usage
const admin = qa()
  .use(adminModule)
  .use(createBlogModule({
    enableComments: true,
    enableDrafts: true,
  }));
```

### Plugin Architecture

```typescript
// modules/plugin-system.ts
interface AdminPlugin {
  name: string;
  module: ReturnType<typeof qa>;
  priority?: number;
}

export function createAdminWithPlugins(plugins: AdminPlugin[]) {
  // Sort by priority
  const sorted = [...plugins].sort(
    (a, b) => (a.priority ?? 0) - (b.priority ?? 0)
  );

  let builder = qa().use(adminModule);

  for (const plugin of sorted) {
    builder = builder.use(plugin.module);
  }

  return builder;
}

// Plugins
const blogPlugin: AdminPlugin = {
  name: "blog",
  module: blogModule,
  priority: 10,
};

const ecommercePlugin: AdminPlugin = {
  name: "ecommerce",
  module: ecommerceModule,
  priority: 20,
};

// Usage
const admin = createAdminWithPlugins([
  blogPlugin,
  ecommercePlugin,
]);
```

### Theme Module

```typescript
// modules/theme-module.ts
export function createThemeModule(theme: {
  primaryColor: string;
  accentColor: string;
  logo?: string;
}) {
  return qa()
    .branding({
      name: "My CMS",
      logo: theme.logo,
      colors: {
        primary: theme.primaryColor,
        accent: theme.accentColor,
      },
    });
}

// Usage
const admin = qa()
  .use(adminModule)
  .use(createThemeModule({
    primaryColor: "#3b82f6",
    accentColor: "#8b5cf6",
    logo: "/logo.svg",
  }));
```

### Localization Module

```typescript
// modules/i18n-module.ts
export function createI18nModule(translations: Record<string, any>) {
  return qa()
    .locale({
      translations,
      defaultLocale: "en",
    });
}

// translations/en.ts
export const enTranslations = {
  collections: {
    posts: {
      label: "Posts",
      fields: {
        title: "Title",
        content: "Content",
      },
    },
  },
  common: {
    save: "Save",
    cancel: "Cancel",
    delete: "Delete",
  },
};

// Usage
const admin = qa()
  .use(adminModule)
  .use(createI18nModule({ en: enTranslations }));
```

## Module Dependencies

Modules can depend on other modules:

```typescript
// This module requires adminModule's fields
const builder = qa<AppCMS>().use(adminModule);

export const blogModule = qa()
  .collections({
    posts: builder.collection("posts")
      .fields(({ r }) => ({
        // r.text() comes from adminModule
        title: r.text({ label: "Title" }),
      })),
  });

// User must include adminModule first
const admin = qa()
  .use(adminModule)    // ← Provides fields
  .use(blogModule);    // ← Uses those fields
```

## Publishing Modules

### Package Structure

```
my-admin-module/
├── src/
│   ├── index.ts         # Main export
│   ├── fields/          # Custom fields
│   ├── widgets/         # Custom widgets
│   ├── collections/     # Collection configs
│   └── components/      # React components
├── package.json
├── tsconfig.json
└── README.md
```

### Package.json

```json
{
  "name": "@my-org/admin-blog-module",
  "version": "1.0.0",
  "main": "dist/index.js",
  "types": "dist/index.d.ts",
  "peerDependencies": {
    "@questpie/admin": "^1.0.0",
    "react": "^18.0.0"
  },
  "exports": {
    ".": {
      "import": "./dist/index.js",
      "types": "./dist/index.d.ts"
    }
  }
}
```

### Main Export

```typescript
// src/index.ts
export { blogModule, createBlogModule } from "./modules/blog";
export type { BlogModuleOptions } from "./modules/blog";

// Re-export components for customization
export { PostCard } from "./components/PostCard";
export { CategoryBadge } from "./components/CategoryBadge";
```

## Testing Modules

```typescript
// __tests__/blog-module.test.ts
import { blogModule } from "../src";

describe("blogModule", () => {
  it("includes posts collection", () => {
    expect(blogModule.state.collections.posts).toBeDefined();
  });

  it("includes sidebar section", () => {
    const sidebar = blogModule.state.sidebar;
    expect(sidebar).toHaveLength(1);
    expect(sidebar[0].label).toBe("Blog");
  });

  it("posts collection has required fields", () => {
    const fields = blogModule.state.collections.posts.fields;
    expect(fields.title).toBeDefined();
    expect(fields.content).toBeDefined();
  });
});
```

## Best Practices

### 1. Document Your Module

```typescript
/**
 * Blog module for QUESTPIE Admin
 *
 * Provides:
 * - Posts collection with rich text editor
 * - Categories collection
 * - Authors collection
 * - Blog sidebar section
 *
 * @example
 * const admin = qa()
 *   .use(adminModule)
 *   .use(blogModule);
 */
export const blogModule = qa()...
```

### 2. Make It Configurable

```typescript
// Don't hardcode values
export function createModule(options: ModuleOptions) {
  return qa().collections({
    posts: createPostsCollection(options),
  });
}
```

### 3. Export Types

```typescript
export type { BlogModuleOptions } from "./types";
export type { PostFields, CategoryFields } from "./collections";
```

### 4. Version Carefully

Follow semver:
- Breaking changes → major version
- New features → minor version
- Bug fixes → patch version

## Related

- [Module Composition](/docs/admin/architecture/module-composition) - How modules merge
- [Custom Fields](/docs/admin/extensibility/custom-fields) - Create new field types
